USE BANCA

SELECT DSCIDADE , COUNT (CDEMPREGADO)
FROM EMPREGADO E JOIN FILIAL F
	ON E.CDFILIAL = F.CDFILIAL
	JOIN CIDADE C
	ON C.CDCIDADE = F.CDCIDADE
GROUP BY DSCIDADE;

SELECT DSDEPARTAMENTO , AVG(VLSALARIO)
FROM EMPREGADO E JOIN DEPARTAMENTO D
	ON E.CDDEPARTAMENTO = D.CDDEPARTAMENTO
	JOIN FILIAL F
	ON D.CDFILIAL = F.CDFILIAL
GROUP BY DSDEPARTAMENTO;

SELECT NMEMPREGADO
FROM EMPREGADO
WHERE VLSALARIO IN (8543, 8255.45, 7012, 4200, 3575.12, 2567, 4599.90, 5378.79, 1250.46);

SELECT EMP.NMEMPREGADO , GER.NMEMPREGADO
FROM EMPREGADO EMP JOIN EMPREGADO GER
ON GER.CDEMPREGADO = EMP.CDGERENTE;
SELECT AVG(VLSALARIO)
FROM EMPREGADO;

SELECT NMEMPREGADO, VLSALARIO 
FROM EMPREGADO
WHERE VLSALARIO < ( SELECT AVG(VLSALARIO) FROM EMPREGADO);

SELECT MIN(VLSALARIO)
FROM EMPREGADO;

SELECT NMEMPREGADO, VLSALARIO
FROM EMPREGADO 
WHERE VLSALARIO = (SELECT MIN(VLSALARIO) FROM EMPREGADO);

SELECT NMEMPREGADO
FROM EMPREGADO 
WHERE CDEMPREGADO IN(SELECT CDGERENTE FROM EMPREGADO);

SELECT DSDEPARTAMENTO, DSFILIAL
FROM EMPREGADO E JOIN DEPARTAMENTO D
ON E.CDDEPARTAMENTO = D.CDDEPARTAMENTO
AND E.CDFILIAL = D.CDFILIAL  
JOIN FILIAL F
ON D.CDFILIAL = F.CDFILIAL
WHERE VLSALARIO = (SELECT MAX(VLSALARIO) FROM EMPREGADO);

SELECT DSCIDADE , COUNT(CDEMPREGADO)
FROM EMPREGADO E JOIN FILIAL F
	ON E.CDFILIAL = F.CDFILIAL
	JOIN CIDADE C
	ON C.CDCIDADE = F.CDCIDADE
WHERE VLSALARIO < (SELECT AVG(VLSALARIO) FROM EMPREGADO)
GROUP BY DSCIDADE;

SELECT AVG(VLSALARIO)
FROM    EMPREGADO E INNER JOIN FILIAL F 
		ON E.CDFILIAL = F.CDFILIAL
		INNER JOIN CIDADE C 
		ON F.CDCIDADE = C.CDCIDADE
WHERE DSCIDADE = 'Curitiba';

SELECT DSDEPARTAMENTO, DSFILIAL
FROM EMPREGADO E JOIN DEPARTAMENTO D 
ON E.CDDEPARTAMENTO = D.CDDEPARTAMENTO
AND E.CDFILIAL = D.CDFILIAL
JOIN FILIAL F
ON D.CDFILIAL = F.CDFILIAL
WHERE VLSALARIO > (SELECT AVG(VLSALARIO)
FROM    EMPREGADO E INNER JOIN FILIAL F 
		ON E.CDFILIAL = F.CDFILIAL
		INNER JOIN CIDADE C 
		ON F.CDCIDADE = C.CDCIDADE
WHERE DSCIDADE = 'Curitiba');

SELECT NMEMPREGADO, VLSALARIO * 1.1
FROM EMPREGADO;

SELECT DSDEPARTAMENTO , DSFILIAL 
FROM EMPREGADO E JOIN DEPARTAMENTO D
ON E.CDDEPARTAMENTO = D.CDDEPARTAMENTO
AND E.CDFILIAL = D.CDFILIAL
JOIN FILIAL F
ON D.CDFILIAL = F.CDFILIAL
WHERE (VLSALARIO*1.1243) < (SELECT AVG(VLSALARIO) FROM EMPREGADO);
